[gd_scene load_steps=31 format=3 uid="uid://r0rlptslyw58"]

[ext_resource type="Script" uid="uid://kygkbg3kqosp" path="res://src/player/player_character_controller.gd" id="1_nsxo0"]
[ext_resource type="Script" uid="uid://cyjt8uhdv01dp" path="res://src/player/follow_camera.gd" id="2_ure5g"]
[ext_resource type="Script" uid="uid://5i4gw4mikjjm" path="res://src/world/navmesh.gd" id="3_0pqet"]
[ext_resource type="TileSet" uid="uid://bnx45rbbsfeci" path="res://assets/catacombs_tileset.tres" id="4_6qv62"]
[ext_resource type="Script" uid="uid://patkktgw1bbd" path="res://src/world/terrain.gd" id="5_rk3es"]
[ext_resource type="Script" uid="uid://ctqjnf2yg1uvt" path="res://src/items/item_data.gd" id="6_cnrih"]
[ext_resource type="PackedScene" uid="uid://cbyjpejpvcygo" path="res://world/Goal.tscn" id="6_wni8n"]
[ext_resource type="PackedScene" uid="uid://cirkhmxhfm3hn" path="res://world/items/Torch.tscn" id="7_3s1lh"]
[ext_resource type="Resource" uid="uid://be2tyr1vni4fl" path="res://world/items/Coin.tres" id="9_qa5mw"]
[ext_resource type="PackedScene" uid="uid://cmubnd2oc4lex" path="res://world/characters/Goblin.tscn" id="10_bbt2j"]
[ext_resource type="Resource" uid="uid://bhfxa754v7msh" path="res://world/items/Diamond.tres" id="10_r0xmj"]
[ext_resource type="Resource" uid="uid://dbufmrasvcauh" path="res://world/items/containers/Backpack.tres" id="11_v2qds"]
[ext_resource type="Script" uid="uid://cvfwxlg4h84qg" path="res://src/world/healing_zone.gd" id="11_wni8n"]
[ext_resource type="Resource" uid="uid://dr5gh87hu4acd" path="res://world/items/containers/Bucket.tres" id="12_hr4si"]
[ext_resource type="Script" uid="uid://dfv4337oq2ve7" path="res://src/world/safe_space.gd" id="12_wni8n"]
[ext_resource type="Resource" uid="uid://dfeldsb6mbdi1" path="res://world/items/containers/Carton.tres" id="13_mq82q"]
[ext_resource type="Resource" uid="uid://bparvikf7wf4g" path="res://world/items/containers/Chest.tres" id="14_kof4o"]
[ext_resource type="Resource" uid="uid://c7s5iuiotlyn1" path="res://world/items/containers/MagicBag.tres" id="15_6avta"]
[ext_resource type="Texture2D" uid="uid://b656w8clmgsyk" path="res://assets/items.png" id="21_5n4mp"]
[ext_resource type="PackedScene" uid="uid://ch0vybwm8dojh" path="res://world/characters/Knight.tscn" id="24_6avta"]
[ext_resource type="PackedScene" uid="uid://bpwkmmuxig2d7" path="res://world/characters/Slime.tscn" id="26_js6p4"]
[ext_resource type="Script" uid="uid://bor4p2l5i5yeu" path="res://src/world/debug_score_test.gd" id="29_7ipd7"]
[ext_resource type="PackedScene" uid="uid://beq3cau0h8ycr" path="res://world/player/health_ui.tscn" id="30_jmh8j"]
[ext_resource type="Script" uid="uid://c85wlydpy0us0" path="res://src/player/health_ui.gd" id="31_rrqg2"]

[sub_resource type="NavigationPolygon" id="NavigationPolygon_y6jnv"]
source_geometry_mode = 1
source_geometry_group_name = &"navmesh_sources"
agent_radius = 22.0

[sub_resource type="AtlasTexture" id="AtlasTexture_yh1pe"]
atlas = ExtResource("21_5n4mp")
region = Rect2(0, 0, 16, 16)

[sub_resource type="Resource" id="Resource_rk3es"]
resource_local_to_scene = true
script = ExtResource("6_cnrih")
display_name = "Torch"
shininess = 2
description = "So bright"
ui_sprite = SubResource("AtlasTexture_yh1pe")
world_scene = ExtResource("7_3s1lh")
metadata/_custom_type_script = "uid://ctqjnf2yg1uvt"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wni8n"]
size = Vector2(129, 126)

[sub_resource type="SystemFont" id="SystemFont_frt76"]

[sub_resource type="LabelSettings" id="LabelSettings_vyb7s"]
font = SubResource("SystemFont_frt76")
font_size = 10
outline_size = 1

[node name="TestDungeon" type="Node"]

[node name="PlayerCharacterController" type="Node" parent="." node_paths=PackedStringArray("character")]
script = ExtResource("1_nsxo0")
character = NodePath("../World/PlayerGoblin")
metadata/_custom_type_script = "uid://kygkbg3kqosp"

[node name="World" type="Node2D" parent="."]
texture_filter = 1

[node name="FollowCamera" type="Camera2D" parent="World" node_paths=PackedStringArray("target")]
zoom = Vector2(4, 4)
script = ExtResource("2_ure5g")
target = NodePath("../PlayerGoblin")
metadata/_custom_type_script = "uid://cyjt8uhdv01dp"

[node name="NavMeshMedium" type="NavigationRegion2D" parent="World" node_paths=PackedStringArray("map")]
navigation_polygon = SubResource("NavigationPolygon_y6jnv")
navigation_layers = 2
script = ExtResource("3_0pqet")
map = NodePath("../Terrain")
metadata/_custom_type_script = "uid://5i4gw4mikjjm"

[node name="Terrain" type="TileMapLayer" parent="World" groups=["navmesh_sources"]]
texture_filter = 1
tile_map_data = PackedByteArray(0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0)
tile_set = ExtResource("4_6qv62")
script = ExtResource("5_rk3es")
WORLD_RADIUS = 20
ROOM_DIM_RANGE = 5
adventurer_scenes = Array[PackedScene]([ExtResource("24_6avta")])
monster_scenes = Array[PackedScene]([ExtResource("26_js6p4")])
treasures = Array[ExtResource("6_cnrih")]([ExtResource("9_qa5mw"), ExtResource("10_r0xmj")])
containers = Array[ExtResource("6_cnrih")]([ExtResource("11_v2qds"), ExtResource("12_hr4si"), ExtResource("13_mq82q"), ExtResource("14_kof4o"), ExtResource("15_6avta")])

[node name="Goal" parent="World" instance=ExtResource("6_wni8n")]
position = Vector2(65, 68)

[node name="CanvasModulate" type="CanvasModulate" parent="World"]
color = Color(0.0672, 0.06826667, 0.08, 1)

[node name="Torch" parent="World" instance=ExtResource("7_3s1lh")]
position = Vector2(34, 102)
item_data = SubResource("Resource_rk3es")

[node name="SafeSpace" type="Area2D" parent="World"]
collision_layer = 0
collision_mask = 2
script = ExtResource("12_wni8n")

[node name="CollisionShape2D" type="CollisionShape2D" parent="World/SafeSpace"]
position = Vector2(63.5, 64)
shape = SubResource("RectangleShape2D_wni8n")

[node name="HealingZone" type="Area2D" parent="World"]
collision_layer = 0
collision_mask = 2
script = ExtResource("11_wni8n")

[node name="CollisionShape2D" type="CollisionShape2D" parent="World/HealingZone"]
position = Vector2(63.5, 64)
shape = SubResource("RectangleShape2D_wni8n")

[node name="Score" type="Label" parent="World"]
light_mask = 0
texture_filter = 1
offset_left = 45.0
offset_top = 86.0
offset_right = 85.0
offset_bottom = 100.0
text = "0"
label_settings = SubResource("LabelSettings_vyb7s")
horizontal_alignment = 1
script = ExtResource("29_7ipd7")

[node name="PlayerGoblin" parent="World" instance=ExtResource("10_bbt2j")]
position = Vector2(64, 32)

[node name="UI" type="CanvasLayer" parent="."]
scale = Vector2(2, 2)
transform = Transform2D(2, 0, 0, 2, 0, 0)

[node name="HealthUI" parent="UI" node_paths=PackedStringArray("character") instance=ExtResource("30_jmh8j")]
anchors_preset = 0
anchor_right = 0.0
anchor_bottom = 0.0
grow_horizontal = 1
grow_vertical = 1
script = ExtResource("31_rrqg2")
character = NodePath("../../World/PlayerGoblin")
