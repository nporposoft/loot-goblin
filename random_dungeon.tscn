[gd_scene load_steps=34 format=3 uid="uid://r0rlptslyw58"]

[ext_resource type="Script" uid="uid://kygkbg3kqosp" path="res://src/player/player_character_controller.gd" id="1_y6nrp"]
[ext_resource type="Script" uid="uid://cyjt8uhdv01dp" path="res://src/player/follow_camera.gd" id="2_j2kls"]
[ext_resource type="Script" uid="uid://chg7uwn1y5tmi" path="res://src/world/navmesh.gd" id="3_r7b6d"]
[ext_resource type="TileSet" uid="uid://bnx45rbbsfeci" path="res://assets/catacombs_tileset.tres" id="4_7odh5"]
[ext_resource type="Script" uid="uid://ps0hext23k73" path="res://src/world/terrain.gd" id="5_57sj4"]
[ext_resource type="PackedScene" uid="uid://ch0vybwm8dojh" path="res://world/characters/Knight.tscn" id="6_us2dd"]
[ext_resource type="PackedScene" uid="uid://bpwkmmuxig2d7" path="res://world/characters/Slime.tscn" id="7_3m7fy"]
[ext_resource type="Script" uid="uid://c0c8qdg6074bn" path="res://src/items/item_data.gd" id="8_3josa"]
[ext_resource type="Resource" uid="uid://be2tyr1vni4fl" path="res://world/items/Coin.tres" id="9_qptnr"]
[ext_resource type="Resource" uid="uid://bhfxa754v7msh" path="res://world/items/Diamond.tres" id="10_1p5v2"]
[ext_resource type="Resource" uid="uid://bhfgsuj1i8rld" path="res://world/items/Torch.tres" id="11_mimim"]
[ext_resource type="Resource" uid="uid://dbufmrasvcauh" path="res://world/items/containers/Backpack.tres" id="12_rp1lr"]
[ext_resource type="Resource" uid="uid://dr5gh87hu4acd" path="res://world/items/containers/Bucket.tres" id="13_6d15t"]
[ext_resource type="Resource" uid="uid://dfeldsb6mbdi1" path="res://world/items/containers/Carton.tres" id="14_n7o02"]
[ext_resource type="Resource" uid="uid://bparvikf7wf4g" path="res://world/items/containers/Chest.tres" id="15_0p8n0"]
[ext_resource type="Resource" uid="uid://c7s5iuiotlyn1" path="res://world/items/containers/MagicBag.tres" id="16_nppw2"]
[ext_resource type="PackedScene" uid="uid://cbyjpejpvcygo" path="res://world/Goal.tscn" id="17_wytvd"]
[ext_resource type="PackedScene" uid="uid://cirkhmxhfm3hn" path="res://world/items/Torch.tscn" id="18_0vrax"]
[ext_resource type="PackedScene" uid="uid://gilrfilnas3p" path="res://world/items/TorchSprite.tscn" id="19_r7b6d"]
[ext_resource type="Texture2D" uid="uid://b656w8clmgsyk" path="res://assets/items.png" id="20_7odh5"]
[ext_resource type="Script" uid="uid://dfv4337oq2ve7" path="res://src/world/safe_space.gd" id="20_buokf"]
[ext_resource type="Script" uid="uid://cvfwxlg4h84qg" path="res://src/world/healing_zone.gd" id="21_yg8g0"]
[ext_resource type="PackedScene" uid="uid://cmubnd2oc4lex" path="res://world/characters/Goblin.tscn" id="23_86tn1"]
[ext_resource type="PackedScene" uid="uid://beq3cau0h8ycr" path="res://world/player/health_ui.tscn" id="24_ssx3i"]
[ext_resource type="Script" uid="uid://c85wlydpy0us0" path="res://src/player/health_ui.gd" id="25_gh7h4"]
[ext_resource type="Script" uid="uid://bwgshxllt467x" path="res://src/world/score_ui.gd" id="25_y6nrp"]
[ext_resource type="PackedScene" uid="uid://culx71ky0dsol" path="res://world/player/game_over.tscn" id="27_57sj4"]

[sub_resource type="NavigationPolygon" id="NavigationPolygon_y6jnv"]
source_geometry_mode = 1
source_geometry_group_name = &"navmesh_sources"
agent_radius = 22.0

[sub_resource type="AtlasTexture" id="AtlasTexture_yh1pe"]
atlas = ExtResource("20_7odh5")
region = Rect2(0, 0, 16, 16)

[sub_resource type="Resource" id="Resource_r7b6d"]
resource_local_to_scene = true
script = ExtResource("8_3josa")
display_name = "Torch"
shininess = 2.0
description = "So bright"
ui_sprite = SubResource("AtlasTexture_yh1pe")
scene_sprite = ExtResource("19_r7b6d")
item_scene = ExtResource("18_0vrax")
exclusive_spawn = true

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wni8n"]
size = Vector2(129, 126)

[sub_resource type="SystemFont" id="SystemFont_5fpyr"]
font_names = PackedStringArray("Sans-Serif")
font_weight = 600
subpixel_positioning = 0

[sub_resource type="LabelSettings" id="LabelSettings_f1q7j"]
font = SubResource("SystemFont_5fpyr")
font_size = 72
font_color = Color(1, 1, 0, 1)

[node name="RandomDungeon" type="Node"]

[node name="PlayerCharacterController" type="Node" parent="." node_paths=PackedStringArray("character")]
script = ExtResource("1_y6nrp")
character = NodePath("../World/PlayerGoblin")
metadata/_custom_type_script = "uid://kygkbg3kqosp"

[node name="World" type="Node2D" parent="."]
texture_filter = 1

[node name="FollowCamera" type="Camera2D" parent="World" node_paths=PackedStringArray("target")]
zoom = Vector2(4, 4)
script = ExtResource("2_j2kls")
target = NodePath("../PlayerGoblin")
metadata/_custom_type_script = "uid://cyjt8uhdv01dp"

[node name="NavMeshMedium" type="NavigationRegion2D" parent="World" node_paths=PackedStringArray("map")]
navigation_polygon = SubResource("NavigationPolygon_y6jnv")
navigation_layers = 2
script = ExtResource("3_r7b6d")
map = NodePath("../Terrain")

[node name="Terrain" type="TileMapLayer" parent="World" groups=["navmesh_sources"]]
texture_filter = 1
tile_map_data = PackedByteArray(0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0)
tile_set = ExtResource("4_7odh5")
script = ExtResource("5_57sj4")
WORLD_RADIUS = 20
ROOM_DIM_RANGE = 5
adventurer_scenes = Array[PackedScene]([ExtResource("6_us2dd")])
monster_scenes = Array[PackedScene]([ExtResource("7_3m7fy")])
treasures = Array[ExtResource("8_3josa")]([ExtResource("9_qptnr"), ExtResource("10_1p5v2"), ExtResource("11_mimim")])
containers = Array[ExtResource("8_3josa")]([ExtResource("12_rp1lr"), ExtResource("13_6d15t"), ExtResource("14_n7o02"), ExtResource("15_0p8n0"), ExtResource("16_nppw2")])

[node name="Goal" parent="World" instance=ExtResource("17_wytvd")]
position = Vector2(65, 68)

[node name="CanvasModulate" type="CanvasModulate" parent="World"]
color = Color(0.0672, 0.06826667, 0.08, 1)

[node name="Torch" parent="World" instance=ExtResource("18_0vrax")]
position = Vector2(34, 102)
item_data = SubResource("Resource_r7b6d")

[node name="SafeSpace" type="Area2D" parent="World"]
collision_layer = 0
collision_mask = 2
script = ExtResource("20_buokf")

[node name="CollisionShape2D" type="CollisionShape2D" parent="World/SafeSpace"]
position = Vector2(63.5, 64)
shape = SubResource("RectangleShape2D_wni8n")

[node name="HealingZone" type="Area2D" parent="World"]
collision_layer = 0
collision_mask = 2
script = ExtResource("21_yg8g0")

[node name="CollisionShape2D" type="CollisionShape2D" parent="World/HealingZone"]
position = Vector2(63.5, 64)
shape = SubResource("RectangleShape2D_wni8n")

[node name="PlayerGoblin" parent="World" instance=ExtResource("23_86tn1")]
position = Vector2(64, 32)

[node name="UI" type="CanvasLayer" parent="."]
scale = Vector2(2, 2)
transform = Transform2D(2, 0, 0, 2, 0, 0)

[node name="HealthUI" parent="UI" node_paths=PackedStringArray("character") instance=ExtResource("24_ssx3i")]
anchors_preset = 0
anchor_right = 0.0
anchor_bottom = 0.0
grow_horizontal = 1
grow_vertical = 1
script = ExtResource("25_gh7h4")
character = NodePath("../../World/PlayerGoblin")

[node name="ScoreUI" type="Label" parent="UI"]
offset_top = 10.0
offset_right = 3840.0
offset_bottom = 92.0
scale = Vector2(0.25, 0.25)
text = "0"
label_settings = SubResource("LabelSettings_f1q7j")
horizontal_alignment = 1
script = ExtResource("25_y6nrp")

[node name="Game Over" parent="UI" node_paths=PackedStringArray("player_character") instance=ExtResource("27_57sj4")]
visible = false
player_character = NodePath("../../World/PlayerGoblin")
